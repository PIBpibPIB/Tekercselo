unit Buttons;
uses
  PWM,
  feedrate,
  Display,
  Declarations;
  
procedure Buttons_mainloop;

//display photo:  ac:display

//------------------------------------------------------------------------------
//
//                 UP
//  SELECT  LEFT       RIGHT RST
//                DOWN
//
//                 2
//  0       1          4     5
//                 3
//------------------------------------------------------------------------------
implementation
const
  SELECT     = 0;
  LEFT       = 1;
  UP         = 2;
  DOWN       = 3;
  RIGHT      = 4;
  RST        = 5;

  ENDSTOP_R   = 6;
  ENDSTOP_L   = 7;



procedure Buttons_mainloop;
var
  wi : word;
  bi : byte;
begin
  if BUTTONFLAGS > 0 then
  begin
    for i := 0 to 7 do
    begin
      if BUTTONFLAGS.i = 1 then
      begin
        case i of
          //--------------------------------------------------------------
          SELECT :  //D.0
          begin
            DIR := not DIR;
          end;
          //--------------------------------------------------------------
          LEFT :    //D.1
          begin
          end;
          //--------------------------------------------------------------
          UP :      //D.2
          begin
            wi := Feedrate_Get;
            wi := wi + 10;
            Feedrate_Set(wi);
            
            LCD_refreshvalues;
          end;
          //--------------------------------------------------------------
          DOWN :    //D.3
          begin
            wi := Feedrate_Get;
            if wi > 10 then
            begin
              wi := wi - 10;
              Feedrate_Set(wi);
            end;
            
            LCD_refreshvalues;
          end;
          //--------------------------------------------------------------
          RIGHT :
          begin
            bi := PWM_Get;
          end;
          //--------------------------------------------------------------
          RST :         //D5
          begin
            liCounter := 0;
            LCD_refreshvalues;
          end;
          //--------------------------------------------------------------
          ENDSTOP_R :   //D6
          begin
            DIR := not DIR;
          end;
          //--------------------------------------------------------------
          ENDSTOP_L :   //D7
          begin
            DIR := not DIR;
          end;
          //--------------------------------------------------------------
        end;

        BUTTONFLAGS.i := 0;
      end;
    end;
  end;
end;
//------------------------------------------------------------------------------
end.
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------